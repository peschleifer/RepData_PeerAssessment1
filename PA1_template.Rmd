---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
---


## Loading and preprocessing the data

Make sure we have the needed packages loaded - this analysis requires dplyr and ggplot2
```{r libs,results='hide'}
if ( !(require(dplyr) &&require(ggplot2)) ) {
    stop ("You need to install the dplyr and ggplot2 packages to run this script")
}
```

Unzip and read the activity data file. Convert the date column into a date
```{r}
actMonRaw <- read.csv( unz('activity.zip','activity.csv'))
actMon <- tbl_df(actMonRaw) %>%
    mutate( date = as.Date(date) )
```

## What is mean total number of steps taken per day?
Calculate the number of steps taken each day by taking the sum of the number of steps in each 5 minute interval during the day. Missing values are ignored in this part.
```{r}
dailySteps <- actMon %>%
    group_by( date ) %>%
    summarize( steps = sum(steps, na.rm=TRUE) )
```

Let's see a histogram of the number of steps per day
```{r echo=FALSE}
qplot( steps, data=dailySteps, xlab="Daily Steps", binwidth=max(dailySteps$steps)/50 )
```

The mean number of steps taken each day is `r sprintf("%.2f", mean(dailySteps$steps))`. The median is `r median(dailySteps$steps)`. For calculating these numbers, the number of steps on days with no readings is 0. if we exclude those days the results are `r sprintf("%.2f", mean(dailySteps$steps[dailySteps$steps>0]))` for the mean and `r median(dailySteps$steps[dailySteps$steps>0])` for the median.


## What is the average daily activity pattern?

Find the average number of steps in each 5 minute interval, ignoring missing values.
We'll count the number of days data was actually collected for each interval, and use that in the average.
```{r}
intervalSteps <- actMon %>%
    group_by( interval ) %>%
    summarize( daysCollected = sum(!is.na(steps)), steps = sum(steps, na.rm=TRUE) )
```

The average steps within each interval
```{r echo=FALSE}
with( intervalSteps, plot( interval, 
                           steps/daysCollected, 
                           type="l", 
                           xlab="Interval",
                           ylab="Average steps per day"))
```

The interval that contains, on average, the maximum number of steps is
`r intervalSteps[with(intervalSteps, which.max(steps/daysCollected, na.rm=TRUE) ),1]`

## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
